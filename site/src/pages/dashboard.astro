---
// Example: Creator/Community growth dashboard (interactive, no backend).
// All data is static JSON and computed client-side.
---

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Example Dashboard — Logentica</title>
  </head>

  <body class="min-h-screen bg-zinc-950 text-zinc-100">
    <!-- Background texture -->
    <div class="pointer-events-none fixed inset-0">
      <div class="absolute inset-0 bg-[radial-gradient(ellipse_at_top,rgba(255,255,255,0.10),transparent_55%)]"></div>
      <div class="absolute inset-0 bg-[radial-gradient(ellipse_at_bottom,rgba(255,255,255,0.06),transparent_60%)]"></div>
      <div class="absolute inset-0 opacity-[0.07] [background-image:linear-gradient(rgba(255,255,255,0.08)_1px,transparent_1px),linear-gradient(90deg,rgba(255,255,255,0.08)_1px,transparent_1px)] [background-size:48px_48px]"></div>
    </div>

    <main class="relative mx-auto max-w-6xl px-5 py-10 sm:px-8">
      <!-- Top bar -->
      <header class="flex flex-col gap-6 sm:flex-row sm:items-start sm:justify-between">
        <div>
          <div class="flex items-center gap-3">
            <div class="h-9 w-9 rounded-xl border border-white/10 bg-white/5"></div>
            <div>
              <div class="text-xs uppercase tracking-widest text-zinc-400">Public demo · no auth · template-ready</div>
              <h1 class="mt-1 text-3xl font-semibold tracking-tight">Creator Community Growth</h1>
            </div>
          </div>
          <p class="mt-4 max-w-2xl text-sm text-zinc-300">
            This is a niche dashboard people actually want: it answers “what content drives signups?”, “who converts?”,
            and “are we retaining paid members?” — with drilldowns you can act on.
          </p>
        </div>

        <div class="flex flex-wrap items-center gap-2 sm:justify-end">
          <div class="rounded-xl border border-white/10 bg-white/5 px-3 py-2">
            <div class="text-[11px] text-zinc-400">Time range</div>
            <select
              id="range"
              class="mt-1 w-full bg-transparent text-sm font-medium outline-none"
              aria-label="Time range"
            >
              <option value="7d" selected>Last 7 days</option>
              <option value="30d">Last 30 days</option>
            </select>
          </div>

          <div class="rounded-xl border border-white/10 bg-white/5 px-3 py-2">
            <div class="text-[11px] text-zinc-400">Segment</div>
            <select id="segment" class="mt-1 w-full bg-transparent text-sm font-medium outline-none" aria-label="Segment">
              <option value="all" selected>All</option>
              <option value="free">Free</option>
              <option value="paid">Paid</option>
            </select>
          </div>

          <button
            id="export"
            class="rounded-xl border border-white/10 bg-white/5 px-3 py-2 text-sm text-zinc-200 hover:bg-white/10"
          >
            Export CSV
          </button>

          <a href="/" class="rounded-xl border border-white/10 bg-white/5 px-3 py-2 text-sm text-zinc-200 hover:bg-white/10">Home</a>
        </div>
      </header>

      <!-- KPI grid -->
      <section class="mt-10 grid gap-4 sm:grid-cols-2 lg:grid-cols-4">
        <div class="relative overflow-hidden rounded-2xl border border-white/10 bg-white/5 p-5">
          <div class="absolute inset-x-0 top-0 h-px bg-gradient-to-r from-transparent via-white/20 to-transparent"></div>
          <div class="text-xs uppercase tracking-wider text-zinc-400">Active members</div>
          <div class="mt-2 text-2xl font-semibold tracking-tight" data-kpi="active_members">—</div>
          <div class="mt-1 text-sm text-emerald-300" data-kpi-delta="active_members">—</div>
          <svg class="mt-3" width="104" height="28" viewBox="0 0 104 28" data-spark="active_members"></svg>
        </div>

        <div class="relative overflow-hidden rounded-2xl border border-white/10 bg-white/5 p-5">
          <div class="absolute inset-x-0 top-0 h-px bg-gradient-to-r from-transparent via-white/20 to-transparent"></div>
          <div class="text-xs uppercase tracking-wider text-zinc-400">Weekly retention</div>
          <div class="mt-2 text-2xl font-semibold tracking-tight" data-kpi="weekly_retention">—</div>
          <div class="mt-1 text-sm text-emerald-300" data-kpi-delta="weekly_retention">—</div>
          <svg class="mt-3" width="104" height="28" viewBox="0 0 104 28" data-spark="weekly_retention"></svg>
        </div>

        <div class="relative overflow-hidden rounded-2xl border border-white/10 bg-white/5 p-5">
          <div class="absolute inset-x-0 top-0 h-px bg-gradient-to-r from-transparent via-white/20 to-transparent"></div>
          <div class="text-xs uppercase tracking-wider text-zinc-400">Conversions</div>
          <div class="mt-2 text-2xl font-semibold tracking-tight" data-kpi="conversions">—</div>
          <div class="mt-1 text-sm text-emerald-300" data-kpi-delta="conversions">—</div>
          <svg class="mt-3" width="104" height="28" viewBox="0 0 104 28" data-spark="conversions"></svg>
        </div>

        <div class="relative overflow-hidden rounded-2xl border border-white/10 bg-white/5 p-5">
          <div class="absolute inset-x-0 top-0 h-px bg-gradient-to-r from-transparent via-white/20 to-transparent"></div>
          <div class="text-xs uppercase tracking-wider text-zinc-400">MRR</div>
          <div class="mt-2 text-2xl font-semibold tracking-tight" data-kpi="mrr">—</div>
          <div class="mt-1 text-sm text-emerald-300" data-kpi-delta="mrr">—</div>
          <svg class="mt-3" width="104" height="28" viewBox="0 0 104 28" data-spark="mrr"></svg>
        </div>
      </section>

      <!-- Main chart + insights -->
      <section class="mt-6 grid gap-6 lg:grid-cols-3">
        <div class="rounded-2xl border border-white/10 bg-white/5 p-6 lg:col-span-2">
          <div class="flex flex-col gap-3 sm:flex-row sm:items-start sm:justify-between">
            <div>
              <h2 class="text-lg font-semibold tracking-tight">Engagement → Signups → Activation</h2>
              <p class="mt-1 text-sm text-zinc-400">
                Hover to see values. Toggle series. This is the core story: content drives engagement, engagement drives signups.
              </p>
            </div>

            <div class="flex flex-wrap items-center gap-2">
              <button class="series-toggle rounded-lg border border-white/10 bg-white/5 px-2 py-1 text-xs text-zinc-300" data-series="engagement" aria-pressed="true">Engagement</button>
              <button class="series-toggle rounded-lg border border-white/10 bg-transparent px-2 py-1 text-xs text-zinc-500" data-series="signup" aria-pressed="true">Signups</button>
              <button class="series-toggle rounded-lg border border-white/10 bg-transparent px-2 py-1 text-xs text-zinc-500" data-series="activation" aria-pressed="true">Activation</button>
              <button class="series-toggle rounded-lg border border-white/10 bg-transparent px-2 py-1 text-xs text-zinc-500" data-series="churn" aria-pressed="true">Churn risk</button>
            </div>
          </div>

          <div class="mt-6 overflow-x-auto">
            <div class="relative">
              <svg id="chart" width="920" height="240" viewBox="0 0 920 240" class="block"></svg>
              <div id="tooltip" class="pointer-events-none absolute hidden rounded-xl border border-white/10 bg-black/80 px-3 py-2 text-xs text-zinc-200 backdrop-blur">
                <div class="font-medium" data-tip-title>—</div>
                <div class="mt-1 grid gap-1" data-tip-body></div>
              </div>
            </div>
          </div>

          <div class="mt-6 grid gap-3 sm:grid-cols-2">
            <div class="rounded-xl border border-white/10 bg-black/20 px-4 py-3">
              <div class="text-xs text-zinc-400">What’s working</div>
              <div class="mt-1 text-sm text-zinc-200">
                Referral + social are accelerating. Double down on posts that trigger replies (highest signup lift).
              </div>
            </div>
            <div class="rounded-xl border border-white/10 bg-black/20 px-4 py-3">
              <div class="text-xs text-zinc-400">What to build next</div>
              <div class="mt-1 text-sm text-zinc-200">
                Add “lead magnet → onboarding → upsell” automation and a weekly cohort email. This reduces churn risk.
              </div>
            </div>
          </div>
        </div>

        <aside class="rounded-2xl border border-white/10 bg-white/5 p-6">
          <h3 class="text-lg font-semibold tracking-tight">Retention cohorts (WOW)</h3>
          <p class="mt-1 text-sm text-zinc-400">A cohort heatmap instantly shows whether changes improved retention.</p>

          <div class="mt-5 overflow-hidden rounded-xl border border-white/10 bg-black/20">
            <div class="grid" style="grid-template-columns: 84px repeat(6, 1fr)">
              <div class="p-3 text-[11px] text-zinc-500">Cohort</div>
              {[0, 1, 2, 3, 4, 5].map((i) => (
                <div class="p-3 text-[11px] text-zinc-500 text-center">W{i}</div>
              ))}

              <div id="cohorts" class="contents"></div>
            </div>
          </div>

          <div class="mt-5 rounded-xl border border-white/10 bg-black/20 p-4">
            <div class="text-xs uppercase tracking-wider text-zinc-500">Interpretation</div>
            <p class="mt-2 text-sm text-zinc-200">
              If later cohorts stay brighter longer, your onboarding + product wedge improved stickiness.
              This is the kind of “niche stat” that sells.
            </p>
          </div>
        </aside>
      </section>

      <!-- Table: top creators / influencers -->
      <section class="mt-6 rounded-2xl border border-white/10 bg-white/5 p-6">
        <div class="flex flex-col gap-2 sm:flex-row sm:items-center sm:justify-between">
          <div>
            <h3 class="text-lg font-semibold tracking-tight">Top influencers (conversion impact)</h3>
            <p class="mt-1 text-sm text-zinc-400">
              A niche would want this because it tells them who to collaborate with — not just who is loud.
            </p>
          </div>
          <div class="text-xs text-zinc-500">Click headers to sort</div>
        </div>

        <div class="mt-4 overflow-hidden rounded-xl border border-white/10">
          <table class="w-full text-sm" id="top-table">
            <thead class="bg-black/30">
              <tr>
                <th class="px-4 py-3 text-left font-medium text-zinc-400" data-sort="name">Account</th>
                <th class="px-4 py-3 text-right font-medium text-zinc-400" data-sort="followers">Followers</th>
                <th class="px-4 py-3 text-right font-medium text-zinc-400" data-sort="posts">Posts</th>
                <th class="px-4 py-3 text-right font-medium text-zinc-400" data-sort="engagement">Engagement</th>
                <th class="px-4 py-3 text-right font-medium text-zinc-400" data-sort="converts">Conversions</th>
              </tr>
            </thead>
            <tbody class="divide-y divide-white/10" id="top-body"></tbody>
          </table>
        </div>
      </section>

      <footer class="mt-10 border-t border-white/10 pt-6 text-xs text-zinc-500">
        <div class="flex flex-col gap-2 sm:flex-row sm:items-center sm:justify-between">
          <div>
            Template notes: keep it public/no-auth. Add a thin adapter for real data.
            If you can explain the dashboard in 10 seconds, it converts.
          </div>
          <div class="text-zinc-600">© {new Date().getFullYear()} Logentica</div>
        </div>
      </footer>

      <script is:inline>
        const fmt = {
          int: (n) => new Intl.NumberFormat(undefined).format(Math.round(n)),
          pct: (n) => `${n.toFixed(1)}%`,
          money: (n) => new Intl.NumberFormat(undefined, { style: 'currency', currency: 'USD', maximumFractionDigits: 0 }).format(n),
        };

        const state = {
          range: '7d',
          segment: 'all',
          visible: { engagement: true, signup: true, activation: true, churn: true },
          sort: { key: 'converts', dir: 'desc' },
          data: null,
        };

        const els = {
          range: document.getElementById('range'),
          segment: document.getElementById('segment'),
          export: document.getElementById('export'),
          chart: document.getElementById('chart'),
          tip: document.getElementById('tooltip'),
          tipTitle: document.querySelector('[data-tip-title]'),
          tipBody: document.querySelector('[data-tip-body]'),
          cohorts: document.getElementById('cohorts'),
          topBody: document.getElementById('top-body'),
          topTable: document.getElementById('top-table'),
        };

        function sparkPath(values, w = 104, h = 28, pad = 2) {
          const min = Math.min(...values);
          const max = Math.max(...values);
          const span = Math.max(1e-9, max - min);
          const step = (w - pad * 2) / (values.length - 1);
          const pts = values.map((v, i) => {
            const x = pad + i * step;
            const y = pad + (1 - (v - min) / span) * (h - pad * 2);
            return [x, y];
          });
          const d = pts.map(([x, y], i) => `${i === 0 ? 'M' : 'L'}${x.toFixed(2)} ${y.toFixed(2)}`).join(' ');
          return { d, pts };
        }

        function setKPI(key, value, deltaPct, sparkValues, formatter) {
          const v = document.querySelector(`[data-kpi="${key}"]`);
          const d = document.querySelector(`[data-kpi-delta="${key}"]`);
          const s = document.querySelector(`[data-spark="${key}"]`);
          if (!v || !d || !s) return;

          v.textContent = formatter(value);
          const sign = deltaPct >= 0 ? '+' : '';
          d.textContent = `${sign}${deltaPct.toFixed(1)}% vs prev`;

          const sp = sparkPath(sparkValues);
          s.innerHTML = `
            <path d="${sp.d}" fill="none" stroke="rgba(255,255,255,0.72)" stroke-width="2" stroke-linecap="round"></path>
            <circle cx="${sp.pts[sp.pts.length - 1][0]}" cy="${sp.pts[sp.pts.length - 1][1]}" r="2.6" fill="rgba(255,255,255,0.95)"></circle>
          `;
        }

        function drawCohorts(cohorts) {
          const weeks = cohorts.weeks;
          const mat = cohorts.retention;

          const clamp = (x, a, b) => Math.max(a, Math.min(b, x));
          const shade = (p) => {
            const t = clamp(p / 100, 0, 1);
            const a = 0.06 + t * 0.26;
            return `rgba(255,255,255,${a.toFixed(3)})`;
          };

          const rows = [];
          for (let r = 0; r < weeks.length; r++) {
            rows.push(`<div class="p-3 text-[11px] text-zinc-400">${weeks[r]}</div>`);
            for (let c = 0; c < mat[r].length; c++) {
              const val = mat[r][c];
              rows.push(`
                <div
                  class="p-3 text-center text-[11px] text-zinc-200"
                  style="background:${shade(val)}"
                  title="${weeks[r]} · W${c} = ${val}%"
                >
                  ${val}%
                </div>
              `);
            }
          }
          els.cohorts.innerHTML = rows.join('');
        }

        function drawChart(rangeData) {
          const svg = els.chart;
          if (!svg) return;

          const W = 920, H = 240, pad = 18;
          // Series values are read directly from rangeData arrays.
          const labels = rangeData.dates;
          const n = labels.length;
          const step = (W - pad * 2) / (n - 1);

          const vis = state.visible;
          const maxEng = Math.max(...rangeData.engagement);
          const maxSignup = Math.max(...rangeData.signup);
          const maxAct = Math.max(...rangeData.activation);
          const maxChurn = Math.max(...rangeData.churn);

          function y(v, kind) {
            const inner = H - pad * 2;
            if (kind === 'engagement') return pad + (1 - v / maxEng) * inner;
            if (kind === 'signup') return pad + (1 - v / maxSignup) * inner;
            if (kind === 'activation') return pad + (1 - v / maxAct) * inner;
            if (kind === 'churn') return pad + (v / maxChurn) * inner; // lower is better => invert story
            return pad + inner / 2;
          }

          const colors = {
            engagement: 'rgba(255,255,255,0.90)',
            signup: 'rgba(255,255,255,0.55)',
            activation: 'rgba(255,255,255,0.72)',
            churn: 'rgba(16,185,129,0.75)',
          };

          const grid = [0.25, 0.5, 0.75]
            .map((t) => {
              const yy = pad + t * (H - pad * 2);
              return `<line x1="${pad}" y1="${yy}" x2="${W - pad}" y2="${yy}" stroke="rgba(255,255,255,0.08)" stroke-width="1" />`;
            })
            .join('');

          function poly(kind) {
            const data = rangeData[kind];
            const pts = data
              .map((v, i) => {
                const xx = pad + i * step;
                const yy = y(v, kind);
                return `${xx},${yy}`;
              })
              .join(' ');
            return { pts };
          }

          const lines = Object.keys(vis)
            .filter((k) => vis[k])
            .map((kind) => {
              const p = poly(kind);
              return `
                <polyline points="${p.pts}" fill="none" stroke="${colors[kind]}" stroke-width="${kind === 'engagement' ? 2.6 : 2.0}" stroke-linecap="round" stroke-linejoin="round" />
              `;
            })
            .join('');

          const dots = labels
            .map((lbl, i) => {
              const xx = pad + i * step;
              const dotBits = Object.keys(vis)
                .filter((k) => vis[k])
                .map((kind) => {
                  const yy = y(rangeData[kind][i], kind);
                  return `<circle cx="${xx}" cy="${yy}" r="3.0" fill="${colors[kind]}" />`;
                })
                .join('');
              const text = `<text x="${xx}" y="${H - 6}" text-anchor="middle" font-size="10" fill="rgba(255,255,255,0.55)">${lbl}</text>`;
              return `<g>${dotBits}${text}</g>`;
            })
            .join('');

          const overlay = `<rect x="${pad}" y="${pad}" width="${W - pad * 2}" height="${H - pad * 2}" fill="transparent" id="overlay" />`;

          svg.innerHTML = `
            <defs>
              <linearGradient id="fade" x1="0" y1="0" x2="0" y2="1">
                <stop offset="0%" stop-color="rgba(255,255,255,0.18)" />
                <stop offset="100%" stop-color="rgba(255,255,255,0.00)" />
              </linearGradient>
            </defs>
            ${grid}
            ${lines}
            ${dots}
            ${overlay}
          `;

          const overlayEl = svg.querySelector('#overlay');
          if (!overlayEl) return;

          overlayEl.addEventListener('mousemove', (e) => {
            const rect = svg.getBoundingClientRect();
            const mx = e.clientX - rect.left;
            const idx = Math.round((mx - pad) / step);
            const i = Math.max(0, Math.min(n - 1, idx));

            els.tip.classList.remove('hidden');
            els.tip.style.left = `${Math.min(rect.width - 220, Math.max(12, mx + 12))}px`;
            els.tip.style.top = `12px`;

            els.tipTitle.textContent = `${rangeData.label} · ${labels[i]}`;

            const rows = [];
            const add = (label, value) => rows.push(`<div class="flex items-center justify-between gap-6"><span class="text-zinc-400">${label}</span><span class="font-medium">${value}</span></div>`);

            if (vis.engagement) add('Engagement', fmt.int(rangeData.engagement[i]));
            if (vis.signup) add('Signups', fmt.int(rangeData.signup[i]));
            if (vis.activation) add('Activation', fmt.int(rangeData.activation[i]));
            if (vis.churn) add('Churn risk', fmt.pct(rangeData.churn[i]));
            els.tipBody.innerHTML = rows.join('');
          });

          overlayEl.addEventListener('mouseleave', () => {
            els.tip.classList.add('hidden');
          });
        }

        function renderTopTable(rows) {
          const { key, dir } = state.sort;
          const sorted = [...rows].sort((a, b) => {
            const av = a[key];
            const bv = b[key];
            if (typeof av === 'string') return dir === 'asc' ? av.localeCompare(bv) : bv.localeCompare(av);
            return dir === 'asc' ? av - bv : bv - av;
          });

          els.topBody.innerHTML = sorted
            .map(
              (r) => `
              <tr class="bg-black/10 hover:bg-white/5">
                <td class="px-4 py-3 text-zinc-200">${r.name}</td>
                <td class="px-4 py-3 text-right font-medium text-zinc-100">${fmt.int(r.followers)}</td>
                <td class="px-4 py-3 text-right text-zinc-200">${fmt.int(r.posts)}</td>
                <td class="px-4 py-3 text-right text-zinc-200">${r.engagement.toFixed(1)}</td>
                <td class="px-4 py-3 text-right text-emerald-300">${fmt.int(r.converts)}</td>
              </tr>
            `
            )
            .join('');
        }

        function exportCSV(data, rangeKey) {
          const r = data.ranges[rangeKey];
          const cols = ['label', ...r.dates];
          const lines = [];
          lines.push(cols.join(','));
          const addRow = (label, arr) => lines.push([label, ...arr].join(','));
          addRow('engagement', r.engagement);
          addRow('signup', r.signup);
          addRow('activation', r.activation);
          addRow('churn', r.churn);

          const blob = new Blob([lines.join('\n')], { type: 'text/csv;charset=utf-8' });
          const url = URL.createObjectURL(blob);
          const a = document.createElement('a');
          a.href = url;
          a.download = `dashboard-${rangeKey}.csv`;
          document.body.appendChild(a);
          a.click();
          a.remove();
          URL.revokeObjectURL(url);
        }

        function segmentMultiplier(seg) {
          if (seg === 'free') return { active: 0.78, conv: 0.62, mrr: 0.28, retention: 0.86, churn: 1.10 };
          if (seg === 'paid') return { active: 0.22, conv: 0.38, mrr: 0.72, retention: 1.18, churn: 0.72 };
          return { active: 1, conv: 1, mrr: 1, retention: 1, churn: 1 };
        }

        function render() {
          if (!state.data) return;
          const data = state.data;
          const m = segmentMultiplier(state.segment);

          const base = data.kpis;
          // Sparklines are synthetic but consistent.
          setKPI('active_members', base.active_members.value * m.active, base.active_members.delta, [12, 13, 12, 14, 15, 16, 18], fmt.int);
          setKPI('weekly_retention', base.weekly_retention.value * m.retention, base.weekly_retention.delta, [32, 33, 34, 35, 37, 39, 41], (v) => `${Math.round(v)}%`);
          setKPI('conversions', base.conversions.value * m.conv, base.conversions.delta, [10, 12, 11, 14, 15, 16, 18], fmt.int);
          setKPI('mrr', base.mrr.value * m.mrr, base.mrr.delta, [6200, 6400, 6600, 6900, 7200, 7600, 7940], fmt.money);

          const rangeData = {
            ...data.ranges[state.range],
            label: data.ranges[state.range].label,
            churn: data.ranges[state.range].churn.map((x) => x * m.churn),
          };

          drawChart(rangeData);
          drawCohorts(data.cohorts);
          renderTopTable(data.top_creators);
        }

        async function init() {
          const res = await fetch('/demo/community_growth.json');
          state.data = await res.json();

          els.range.addEventListener('change', () => {
            state.range = els.range.value;
            render();
          });

          els.segment.addEventListener('change', () => {
            state.segment = els.segment.value;
            render();
          });

          document.querySelectorAll('.series-toggle').forEach((btn) => {
            btn.addEventListener('click', () => {
              const key = btn.getAttribute('data-series');
              state.visible[key] = !state.visible[key];
              btn.setAttribute('aria-pressed', String(state.visible[key]));
              btn.classList.toggle('text-zinc-300', state.visible[key]);
              btn.classList.toggle('text-zinc-500', !state.visible[key]);
              btn.classList.toggle('bg-white/5', state.visible[key]);
              btn.classList.toggle('bg-transparent', !state.visible[key]);
              render();
            });
          });

          els.topTable.querySelectorAll('th[data-sort]').forEach((th) => {
            th.style.cursor = 'pointer';
            th.addEventListener('click', () => {
              const key = th.getAttribute('data-sort');
              if (state.sort.key === key) {
                state.sort.dir = state.sort.dir === 'asc' ? 'desc' : 'asc';
              } else {
                state.sort.key = key;
                state.sort.dir = 'desc';
              }
              render();
            });
          });

          els.export.addEventListener('click', () => exportCSV(state.data, state.range));

          render();
        }

        init();
      </script>
    </main>
  </body>
</html>
